---
phase: 04-github-domain-consolidation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/backend/domains/github/pr-review-fixer.service.ts
  - src/backend/domains/github/pr-review-monitor.service.ts
  - src/backend/services/pr-review-fixer.service.ts
  - src/backend/services/pr-review-monitor.service.ts
autonomous: true

must_haves:
  truths:
    - "pr-review-fixer.service.ts lives at src/backend/domains/github/ with all exports preserved"
    - "pr-review-monitor.service.ts lives at src/backend/domains/github/ with all exports preserved"
    - "Old service paths still work via re-export shims"
    - "All existing tests pass (no regressions)"
  artifacts:
    - path: "src/backend/domains/github/pr-review-fixer.service.ts"
      provides: "PR review fix session management"
      exports: ["prReviewFixerService", "ReviewCommentDetails", "PRReviewFixResult"]
    - path: "src/backend/domains/github/pr-review-monitor.service.ts"
      provides: "Polling loop for review comments"
      exports: ["prReviewMonitorService"]
    - path: "src/backend/services/pr-review-fixer.service.ts"
      provides: "Re-export shim for backward compatibility"
    - path: "src/backend/services/pr-review-monitor.service.ts"
      provides: "Re-export shim (note: zero external consumers currently)"
  key_links:
    - from: "src/backend/domains/github/pr-review-monitor.service.ts"
      to: "src/backend/domains/github/pr-review-fixer.service.ts"
      via: "intra-domain relative import"
      pattern: "from './pr-review-fixer.service'"
    - from: "src/backend/domains/github/pr-review-monitor.service.ts"
      to: "src/backend/domains/github/github-cli.service.ts"
      via: "intra-domain relative import"
      pattern: "from './github-cli.service'"
---

<objective>
Move pr-review-fixer.service.ts (244 LOC) and pr-review-monitor.service.ts (334 LOC) into src/backend/domains/github/. Create re-export shims at old paths.

Purpose: Complete the GitHub domain file migration. These two files form the review monitoring subsystem. pr-review-monitor depends on both pr-review-fixer and github-cli, so intra-domain relative imports keep them self-contained.
Output: 2 new domain files + 2 shims at old paths.
</objective>

<execution_context>
@/Users/martin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/martin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move pr-review-fixer.service.ts to domain</name>
  <files>
    src/backend/domains/github/pr-review-fixer.service.ts
    src/backend/services/pr-review-fixer.service.ts
  </files>
  <action>
1. Copy `src/backend/services/pr-review-fixer.service.ts` to `src/backend/domains/github/pr-review-fixer.service.ts`.
2. In the new domain file, update import paths:
   - `@prisma-gen/client` stays as-is (already absolute)
   - `./fixer-session.service` -> `@/backend/services/fixer-session.service` (cross-domain, absolute)
   - `./logger.service` -> `@/backend/services/logger.service` (cross-domain, absolute)
   - `./session.service` -> `@/backend/services/session.service` (cross-domain via shim, absolute)
3. Replace old `src/backend/services/pr-review-fixer.service.ts` with a re-export shim:
   ```typescript
   /**
    * @deprecated Import from '@/backend/domains/github' instead.
    * This re-export shim will be removed in Phase 9 (Import Rewiring).
    */
   export {
     type PRReviewFixResult,
     type ReviewCommentDetails,
     prReviewFixerService,
   } from '@/backend/domains/github/pr-review-fixer.service';
   ```
4. No test file exists for pr-review-fixer — the domain smoke test (Plan 03) will verify its export is defined.
  </action>
  <verify>
Run `pnpm typecheck` to confirm no type errors. Verify the shim resolves by checking that `src/backend/services/index.ts` still exports the three names from `./pr-review-fixer.service` without errors.
  </verify>
  <done>pr-review-fixer.service.ts lives in domains/github/, cross-domain imports use absolute @/backend/ paths, shim at old path re-exports all 3 exported names, typecheck passes.</done>
</task>

<task type="auto">
  <name>Task 2: Move pr-review-monitor.service.ts to domain</name>
  <files>
    src/backend/domains/github/pr-review-monitor.service.ts
    src/backend/services/pr-review-monitor.service.ts
  </files>
  <action>
1. Copy `src/backend/services/pr-review-monitor.service.ts` to `src/backend/domains/github/pr-review-monitor.service.ts`.
2. In the new domain file, update import paths:
   - `../resource_accessors/workspace.accessor` -> `@/backend/resource_accessors/workspace.accessor` (cross-domain, absolute)
   - `./constants` -> `@/backend/services/constants` (cross-domain, absolute)
   - `./github-cli.service` -> `./github-cli.service` (intra-domain relative — will resolve to github-cli in same domain dir)
   - `./logger.service` -> `@/backend/services/logger.service` (cross-domain, absolute)
   - `./pr-review-fixer.service` -> `./pr-review-fixer.service` (intra-domain relative — both now in same domain dir)
   - Also update the `type ReviewCommentDetails` import: it comes from `./pr-review-fixer.service` which stays relative
   - `./rate-limit-backoff` -> `@/backend/services/rate-limit-backoff` (cross-domain, absolute)
3. Replace old `src/backend/services/pr-review-monitor.service.ts` with a re-export shim:
   ```typescript
   /**
    * @deprecated Import from '@/backend/domains/github' instead.
    * This re-export shim will be removed in Phase 9 (Import Rewiring).
    */
   export { prReviewMonitorService } from '@/backend/domains/github/pr-review-monitor.service';
   ```
   Note: pr-review-monitor has ZERO external consumers (never imported by any other file), so this shim exists only for completeness. It can be omitted if preferred, but keeping it is consistent with the move-and-shim pattern.
4. No test file exists for pr-review-monitor — the domain smoke test (Plan 03) will verify its export is defined.
  </action>
  <verify>
Run `pnpm typecheck` to confirm no type errors. Verify the intra-domain imports resolve: pr-review-monitor.service.ts imports from `./github-cli.service` and `./pr-review-fixer.service` which both now live in domains/github/.
  </verify>
  <done>pr-review-monitor.service.ts lives in domains/github/, intra-domain imports to github-cli and pr-review-fixer use relative paths, cross-domain imports use absolute @/backend/ paths, shim at old path, typecheck passes.</done>
</task>

</tasks>

<verification>
- `pnpm typecheck` passes with zero errors
- `pnpm test -- --run` full suite passes (no regressions from shims)
- Old import paths still resolve (shims work)
- Intra-domain relative imports in pr-review-monitor correctly point to sibling files in domains/github/
</verification>

<success_criteria>
- pr-review-fixer.service.ts (244 LOC) and pr-review-monitor.service.ts (334 LOC) live in src/backend/domains/github/
- pr-review-monitor uses intra-domain relative imports for github-cli and pr-review-fixer
- pr-review-fixer uses absolute @/backend/ paths for cross-domain deps (fixer-session, session, logger)
- Re-export shims at old services/ paths maintain backward compatibility
- All existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/04-github-domain-consolidation/04-02-SUMMARY.md`
</output>
