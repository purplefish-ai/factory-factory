---
phase: 10-validation-stabilization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - AGENTS.md
  - .planning/codebase/ARCHITECTURE.md
  - .architecture/HOTSPOTS_2026-02.md
  - .architecture/README.md
  - .planning/REQUIREMENTS.md
  - .planning/ROADMAP.md
  - .planning/STATE.md
autonomous: true

must_haves:
  truths:
    - "AGENTS.md describes the domain module pattern for AI agents working on this codebase"
    - "ARCHITECTURE.md reflects the post-refactor backend structure with 6 domain modules"
    - "All 34 v1 requirements are marked Done in REQUIREMENTS.md traceability table"
    - "All phase plans in ROADMAP.md are marked complete"
    - "HOTSPOTS analysis is marked as superseded by the SRP refactor"
  artifacts:
    - path: "AGENTS.md"
      provides: "Domain module pattern documentation for AI agents"
      contains: "src/backend/domains/"
    - path: ".planning/REQUIREMENTS.md"
      provides: "Complete traceability table with all 34 requirements marked Done"
      contains: "Done"
    - path: ".planning/ROADMAP.md"
      provides: "All phases and plans marked complete"
      contains: "[x]"
  key_links:
    - from: "AGENTS.md"
      to: "src/backend/domains/"
      via: "Project Structure section"
      pattern: "domains/"
---

<objective>
Update all project documentation to reflect the completed SRP refactor: AGENTS.md, ARCHITECTURE.md, HOTSPOTS, REQUIREMENTS.md traceability, ROADMAP.md completion, and STATE.md final status.

Purpose: Ensure anyone (human or AI) reading the codebase documentation understands the current post-refactor structure. Stale documentation referencing 85+ services and src/backend/claude/ would mislead future contributors.
Output: All documentation files updated to reflect the completed 10-phase refactor.
</objective>

<execution_context>
@/Users/martin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/martin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/10-validation-stabilization/10-RESEARCH.md
@AGENTS.md
@.planning/codebase/ARCHITECTURE.md
@.architecture/HOTSPOTS_2026-02.md
@.architecture/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update AGENTS.md with domain module pattern and ARCHITECTURE.md with post-refactor structure</name>
  <files>AGENTS.md, .planning/codebase/ARCHITECTURE.md</files>
  <action>
  **AGENTS.md updates:**

  In the "Project Structure & Module Organization" section, add after the existing bullet points:

  Add a new subsection describing the domain module pattern:
  - `src/backend/domains/`: Domain modules (session, workspace, github, ratchet, terminal, run-script)
  - `src/backend/orchestration/`: Cross-domain coordination layer (bridges, workspace init/archive)
  - `src/backend/services/`: Infrastructure-only services (logger, config, scheduler, port, health, etc.)

  Add a new section "## Backend Domain Module Pattern" (after "Coding Style & Naming Conventions") with:
  - 6 domains: session, workspace, github, ratchet, terminal, run-script
  - Each domain has an `index.ts` barrel file as the sole public API
  - Consumers must import from barrel (`@/backend/domains/session`), never from internal paths
  - Domains never import from sibling domains (enforced by dependency-cruiser `no-cross-domain-imports` rule)
  - Cross-domain coordination uses bridge interfaces + orchestration layer in `src/backend/orchestration/`
  - `src/backend/services/` contains ONLY infrastructure/cross-cutting services
  - New domain logic goes in `domains/{name}/`, new infrastructure goes in `services/`

  Keep the section concise (10-15 lines). This is a reference for AI agents, not a tutorial.

  **ARCHITECTURE.md updates:**

  Rewrite `.planning/codebase/ARCHITECTURE.md` to reflect the post-refactor structure. Key changes:
  - Replace "85+ services" with accurate description of 6 domain modules + ~25 infrastructure services
  - Remove references to `src/backend/claude/` as a separate directory (now part of session domain)
  - Update Service Layer description to distinguish domain modules from infrastructure services
  - Add Domain Module Layer description between API/RPC Layer and Service Layer
  - Add Orchestration Layer description
  - Update Claude Integration Layer to note it's now inside session domain
  - Update Data Flow examples to reference domain barrel imports
  - Update Key Abstractions to reference domain paths instead of flat services paths
  - Update the Analysis Date to current date

  Preserve all existing sections that are still accurate (entry points, error handling, cross-cutting concerns, frontend UI layer, data layer, resource access layer).
  </action>
  <verify>AGENTS.md contains "domains/" in Project Structure section and has a "Backend Domain Module Pattern" section. ARCHITECTURE.md no longer references "85+ services" or `src/backend/claude/` as a separate directory.</verify>
  <done>AGENTS.md describes domain module pattern for AI agents. ARCHITECTURE.md reflects post-refactor backend structure with 6 domain modules, orchestration layer, and infrastructure-only services.</done>
</task>

<task type="auto">
  <name>Task 2: Update REQUIREMENTS.md traceability, ROADMAP.md completion, HOTSPOTS, .architecture/README, and STATE.md</name>
  <files>.planning/REQUIREMENTS.md, .planning/ROADMAP.md, .architecture/HOTSPOTS_2026-02.md, .architecture/README.md, .planning/STATE.md</files>
  <action>
  **REQUIREMENTS.md updates:**

  1. Change all 34 `- [ ]` checkboxes in the v1 Requirements section to `- [x]`
  2. In the Traceability table, change all 34 "Pending" entries to "Done"
  3. Update the "Last updated" footer to current date with note about Phase 10 completion

  **ROADMAP.md updates:**

  1. Phase 4 plans: Change `- [ ] 04-01-PLAN.md`, `- [ ] 04-02-PLAN.md`, `- [ ] 04-03-PLAN.md` to `- [x]` (these were completed but the roadmap wasn't updated)
  2. Phase 10: Add plans section:
     ```
     **Plans:** 3 plans

     Plans:
     - [x] 10-01-PLAN.md — Dependency-cruiser tightening, barrel enforcement, and Knip cleanup
     - [x] 10-02-PLAN.md — Documentation updates (AGENTS.md, ARCHITECTURE.md, REQUIREMENTS.md, ROADMAP.md)
     - [x] 10-03-PLAN.md — Full CI validation suite and smoke test
     ```
  3. Update the "Last updated" footer to reflect Phase 10 completion

  **HOTSPOTS_2026-02.md updates:**

  Add a prominent notice at the very top of the file (after the title):

  ```
  > **SUPERSEDED:** This analysis was generated pre-refactor (2026-02-09). The SRP Consolidation & Domain Module Refactor (Phases 1-10, completed 2026-02-10) addressed all issues identified here:
  > - "97 service-to-service dependencies" -- Reduced via domain modules and orchestration layer
  > - "session.service.ts 27 dependents" -- Session logic consolidated into `src/backend/domains/session/`
  > - "`src/backend/claude/` mixed concerns" -- Absorbed into session domain at `domains/session/claude/`
  > - Action Plan Phases 1-3 -- Completed by SRP refactor Phases 1-9
  >
  > For current architecture, see `AGENTS.md` and `.planning/codebase/ARCHITECTURE.md`.
  ```

  Do NOT delete the existing content -- it serves as historical record. Just add the superseded notice.

  **.architecture/README.md updates:**

  Update the "Architecture Goals" section to mark all items as complete:
  - Phase 1 items: all `[x]` (dep-cruiser rules added, architecture documented, domain boundaries identified)
  - Phase 2 items: all `[x]` (message/transcript handled within session domain, single-write-path exists, coupling reduced)
  - Phase 3 items: all `[x]` (services refactored into domain modules, coupling improved)
  - Update metrics: "Service-to-Service Coupling" note that domains replaced flat services structure

  **STATE.md updates:**

  1. Change `**Current Phase:** 09-appcontext-import-rewiring (Plan 03 of 03 complete)` to `**Current Phase:** 10-validation-stabilization (Plan 03 of 03 complete)`
  2. Change `**Status:** In Progress` to `**Status:** Complete`
  3. Update Phase 10 row in Progress table from `Pending` to `Complete` with appropriate notes
  4. Update "Context for Next Session" to note that all 10 phases are complete
  5. Update the `Last session` timestamp
  </action>
  <verify>
  - `grep -c "Done" .planning/REQUIREMENTS.md` shows 34 Done entries in traceability table
  - `grep -c "\- \[x\]" .planning/REQUIREMENTS.md` shows 34 checked boxes
  - ROADMAP.md Phase 4 plans marked [x], Phase 10 has plans listed
  - HOTSPOTS file starts with SUPERSEDED notice
  - STATE.md shows Status: Complete
  </verify>
  <done>All 34 requirements marked Done. All roadmap phases/plans marked complete. HOTSPOTS marked as superseded. STATE.md shows project complete.</done>
</task>

</tasks>

<verification>
- AGENTS.md has "Backend Domain Module Pattern" section
- AGENTS.md mentions all 6 domains and orchestration layer
- ARCHITECTURE.md describes domain modules, not "85+ services"
- ARCHITECTURE.md has no references to src/backend/claude/ as separate directory
- REQUIREMENTS.md: 34/34 requirements checked [x] and traceability shows "Done"
- ROADMAP.md: Phase 4 plans marked [x], Phase 10 plans listed and marked [x]
- HOTSPOTS_2026-02.md: Has SUPERSEDED notice at top
- .architecture/README.md: Goals marked complete
- STATE.md: Status is "Complete", Phase 10 marked Complete
</verification>

<success_criteria>
All documentation reflects the completed SRP refactor. No stale references to pre-refactor structure remain in actively-consulted docs. AI agents reading AGENTS.md will understand the domain module pattern. Requirements traceability is complete.
</success_criteria>

<output>
After completion, create `.planning/phases/10-validation-stabilization/10-02-SUMMARY.md`
</output>
