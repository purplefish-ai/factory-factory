---
phase: 10-validation-stabilization
plan: 03
type: execute
wave: 2
depends_on: ["10-01"]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "All 1609+ tests pass with zero failures"
    - "TypeScript strict mode type checking passes with zero errors"
    - "Biome lint and format checks pass with zero violations"
    - "Dependency-cruiser reports zero architectural violations across all 18 rules"
    - "Knip reports zero unused files, dependencies, or unlisted items"
    - "Production build (tsc + vite) succeeds"
    - "Application starts and /health endpoint responds"
  artifacts: []
  key_links:
    - from: "pnpm test"
      to: "1609+ tests"
      via: "vitest test runner"
      pattern: "Tests.*pass"
    - from: "pnpm deps:check"
      to: "0 violations"
      via: "dependency-cruiser (18 rules)"
      pattern: "0 dependency violations"
---

<objective>
Run the full CI validation suite and smoke test to prove the entire refactor is backward-compatible and the dependency graph is clean under the new stricter rules.

Purpose: Final verification of WIRE-04 (backward compatibility) and WIRE-05 (all tests pass). This runs after Plan 01's dep-cruiser tightening and import fixes, validating everything together.
Output: All CI checks passing, smoke test verified. The 10-phase SRP refactor is complete.
</objective>

<execution_context>
@/Users/martin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/martin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-validation-stabilization/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run full CI validation suite</name>
  <files></files>
  <action>
  Run the full CI validation suite in this exact order (matching .github/workflows/ci.yml):

  ```bash
  pnpm check                    # Biome lint (read-only)
  pnpm check:biome-ignores      # No inline suppressions
  pnpm deps:check               # Dependency architecture validation (now 18 rules)
  pnpm knip --include files,dependencies,unlisted  # Dead code check
  pnpm typecheck                # TypeScript strict mode
  pnpm test                     # Full test suite
  pnpm build                    # Production build (tsc + vite)
  ```

  Record the output of each check. Every single one must pass with zero errors/violations.

  IMPORTANT: Run `pnpm check` (read-only), NOT `pnpm check:fix` (which writes). We are validating, not fixing.

  Pay special attention to `pnpm deps:check` â€” this now includes the 4 new rules from Plan 01 (no-deep-domain-imports, no-domains-importing-orchestration, no-domains-importing-routers, no-domains-importing-agents). Confirm the rule count in the output.
  </action>
  <verify>All 7 CI checks pass with zero errors. Dependency-cruiser reports 18 rules checked.</verify>
  <done>Full CI suite passes under stricter architectural rules. All 1609+ tests pass. Build succeeds.</done>
</task>

<task type="auto">
  <name>Task 2: Smoke test application startup and /health endpoint</name>
  <files></files>
  <action>
  Perform a smoke test to verify the application actually starts and responds:

  1. Run `pnpm dev` in the background
  2. Wait up to 15 seconds for the server to become ready
  3. Verify the /health endpoint responds with a success status (curl http://localhost:3001/health or the configured port)
  4. Kill the dev server process

  This test verifies that:
  - The Express server initializes (all DI wiring works at runtime)
  - tRPC routes register (backward compatibility of endpoints)
  - WebSocket upgrade handlers register
  - The frontend Vite dev server starts

  If the port is different from 3001, check the server output for the actual port.

  The smoke test is a runtime verification that complements the static checks from Task 1. Tests use mocks, but the smoke test proves the real wiring works.
  </action>
  <verify>`pnpm dev` starts without crash, /health endpoint returns a successful response.</verify>
  <done>Application starts successfully. /health endpoint responds. Runtime backward compatibility confirmed. WIRE-04 and WIRE-05 validated.</done>
</task>

</tasks>

<verification>
- `pnpm check` passes
- `pnpm check:biome-ignores` passes
- `pnpm deps:check` passes (0 violations, 18 rules)
- `pnpm knip --include files,dependencies,unlisted` passes (0 issues, 0 hints)
- `pnpm typecheck` passes
- `pnpm test` passes (1609+ tests)
- `pnpm build` succeeds
- `pnpm dev` starts and /health responds
</verification>

<success_criteria>
All CI-equivalent checks pass with zero errors under the new stricter dependency-cruiser rules. Application smoke test confirms runtime startup. WIRE-04 and WIRE-05 requirements fully validated. The SRP refactor is verified complete.
</success_criteria>

<output>
After completion, create `.planning/phases/10-validation-stabilization/10-03-SUMMARY.md`
</output>
