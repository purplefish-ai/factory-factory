# FactoryFactory Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# Database Configuration (SQLite)
# =============================================================================

# SQLite database file path (optional - defaults to ~/.factory-factory/data.db)
# DATABASE_PATH=/path/to/data.db

# For Electron production, this is typically set by the main process to:
# DATABASE_PATH="${app.getPath('userData')}/data.db"

# Note: No ANTHROPIC_API_KEY needed - we use OAuth via `claude login`

# =============================================================================
# Server Configuration
# =============================================================================

# Backend server port (default: 4001)
# For production, use different ports (e.g., 5001) to run alongside dev
BACKEND_PORT=4001

# Frontend server port (default: 4000)
# For production, use different ports (e.g., 5000) to run alongside dev
FRONTEND_PORT=4000

# Backend port for frontend WebSocket connections (must match BACKEND_PORT)
# This is a NEXT_PUBLIC_ var so it's available in the browser
NEXT_PUBLIC_BACKEND_PORT=4001

# Node environment (development, production, test)
NODE_ENV=development

# =============================================================================
# Directory Configuration
# =============================================================================

# Base directory for all FactoryFactory data (worktrees, logs, debug files)
# Data automatically migrates from old ~/factory-factory to new ~/.factory-factory
BASE_DIR=/Users/$USER/.factory-factory

# Directory for git worktrees (derived from BASE_DIR by default)
WORKTREE_BASE_DIR=$BASE_DIR/worktrees

# =============================================================================
# Agent Configuration
# =============================================================================

# Model selection (sonnet, opus, haiku)
ORCHESTRATOR_MODEL=sonnet
SUPERVISOR_MODEL=sonnet
WORKER_MODEL=sonnet

# Permission modes (strict, relaxed, yolo)
ORCHESTRATOR_PERMISSIONS=strict
SUPERVISOR_PERMISSIONS=relaxed
WORKER_PERMISSIONS=yolo

# =============================================================================
# Rate Limiting
# =============================================================================

# Claude API rate limits
CLAUDE_RATE_LIMIT_PER_MINUTE=60
CLAUDE_RATE_LIMIT_PER_HOUR=1000

# Maximum Claude sessions (chat windows) per workspace
MAX_SESSIONS_PER_WORKSPACE=5

# Queue settings
RATE_LIMIT_QUEUE_SIZE=100
RATE_LIMIT_QUEUE_TIMEOUT_MS=30000

# =============================================================================
# Health Check Configuration
# =============================================================================

# Health check interval in milliseconds (default: 5 minutes)
HEALTH_CHECK_INTERVAL_MS=300000

# Agent heartbeat threshold in minutes (default: 7)
AGENT_HEARTBEAT_THRESHOLD_MINUTES=7

# =============================================================================
# Crash Recovery Configuration
# =============================================================================

# Maximum worker recovery attempts (default: 5)
MAX_WORKER_ATTEMPTS=5

# Crash loop threshold in milliseconds (default: 1 minute)
CRASH_LOOP_THRESHOLD_MS=60000

# Maximum rapid crashes before marking as crash loop (default: 3)
MAX_RAPID_CRASHES=3

# =============================================================================
# PR Review Configuration
# =============================================================================

# PR review timeout in minutes (default: 60)
PR_REVIEW_TIMEOUT_MINUTES=60

# =============================================================================
# CORS Configuration
# =============================================================================

# Allowed origins (comma-separated)
# Includes both dev (3000/3001) and production (4000/4001) ports
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:4000,http://localhost:4001

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Service name for logs
SERVICE_NAME=factoryfactory

# Enable WebSocket session logs (default: true in development, false otherwise)
# WS_LOGS_ENABLED=true

# WebSocket session logs path (optional)
# WS_LOGS_PATH=/path/to/ws-logs

# =============================================================================
# Notification Configuration
# =============================================================================

# Enable desktop notifications (default: true)
NOTIFICATION_PUSH_ENABLED=true

# Enable notification sounds (default: true)
NOTIFICATION_SOUND_ENABLED=true

# Custom notification sound file (optional)
# NOTIFICATION_SOUND_FILE=/path/to/sound.wav

# Quiet hours (24-hour format, optional)
# NOTIFICATION_QUIET_HOURS_START=22
# NOTIFICATION_QUIET_HOURS_END=8

# =============================================================================
# Feature Flags
# =============================================================================

# Enable authentication (default: false)
FEATURE_AUTHENTICATION=false

# Enable Prometheus metrics (default: false)
FEATURE_METRICS=false

# Enable error tracking (default: false)
FEATURE_ERROR_TRACKING=false

# =============================================================================
# Tmux Configuration (optional)
# =============================================================================

# TMUX_SOCKET_PATH=/tmp/factoryfactory-tmux
